<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password | Modern LMS</title>
    <link rel="stylesheet" href="Login&Signup.css">
    <style>
        /* Professional Video Constraint */
        .login-animation {
            width: 100%;
            max-width: 320px; /* Reduced size for better proportions */
            height: auto;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* Ensure smooth spacing in the dual-pane layout */
        .image-section {
            padding: 60px 40px;
            background: #013E62; /* Subtle light background for the left side */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

	/* Match Login Page Heading Style */
	.reset-title {
 	   font-size: 26px;
   	 font-weight: 700;
   	 background: linear-gradient(to right, #ffffff, var(--primary));
    	-webkit-background-clip: text;
    	-webkit-text-fill-color: transparent;
  	  margin-bottom: 12px;
	}

	/* Form Section Title */
	.form-title {
  	  font-size: 32px;
  	  font-weight: 700;
   	 color: var(--primary);
  	  margin-bottom: 8px;
	}

	.password-meter {
 	   margin-top: 8px;
	}

	.password-wrapper {
 	   position: relative;
	}

	.password-wrapper .toggle {
  	  position: absolute;
   	 right: 12px;
   	 top: 50%;
   	 transform: translateY(-50%);
    	cursor: pointer;
   	 font-size: 14px;
   	 color: #64748b;
	}

	.strength-bar {
	    height: 6px;
	    width: 0%;
	    background: #e5e7eb;
 	   border-radius: 6px;
 	   transition: width 0.3s ease, background 0.3s ease;
	}

	.strength-text {
	    font-size: 12px;
 	   color: #64748b;
  	  margin-top: 4px;
	}

        /* Secondary Button Style */
        .btn-outline {
            display: block;
            width: 100%;
            padding: 12px;
            margin-top: 12px;
            background: transparent;
            border: 2px solid #e2e8f0;
            color: #475569;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .btn-outline:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
            color: #1e293b;
        }

        .error-box {
            font-size: 14px;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="auth-container animate-fade">
    <div class="auth-content">
        <div class="image-section">
            <video autoplay loop muted playsinline class="login-animation">
                <source src="forgotPassword.mp4" type="video/mp4"> </video>
            <h3 class="reset-title">Reset Your Password</h3>
            <p style="color: #64748b; line-height: 1.6;">Provide your registered credentials to securely update your account access.</p>
        </div>

        <div class="form-section">
            <h2 class="form-title">Identity Verification</h2>
            <p class="subtitle">Complete the fields below to continue.</p>
            
            <form onsubmit="handleReset(event)">
                <div class="input-box">
                    <label for="matric">Matric Number</label>
                    <input type="text" id="matric" placeholder="e.g., AI210056" required>
                </div>

                <div class="input-box">
                    <label for="email">Registered Email</label>
                    <input type="email" id="email" placeholder="name@example.com" required>
                </div>

               <div class="input-box">
    <label for="newPassword"></label>

   <div class="input-box">
    <label for="password">Password</label>
    <div class="password-wrapper" style="position: relative;">
        <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        <span class="toggle-icon" onclick="togglePasswordVisibility('password')" 
              style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); cursor: pointer; opacity: 0.6;">
            üëÅÔ∏è
        </span>
    </div>
    <div class="password-meter">
        <div class="strength-bar"></div>
        <p class="strength-text">Password strength</p>
    </div>
</div>
</div>


                <div id="msg" class="error-box"></div>

                <button type="submit" class="btn" id="resetBtn">Update Password</button>

                <a href="login.html" class="btn-outline">Back to Login</a>

                <div class="signup-link">
                    <p>New to the platform? <a href="signup.html">Create Account</a></p>
                </div>
            </form>
        </div>
    </div>
</div>

<footer class="login-footer">
    <div class="footer-content">
        <p>&copy; 2025 LMS Platform. All Rights Reserved.</p>
    </div>
</footer>

<script>
// CORRECT: Matches the id="password" in your HTML
// 1. Target the correct ID "password"
const passwordInput = document.getElementById("password"); 
const bar = document.querySelector(".strength-bar");
const text = document.querySelector(".strength-text");
const btn = document.getElementById("resetBtn");

// 2. Toggle Visibility (Already correct in your code)
function togglePasswordVisibility(inputId) {
    const input = document.getElementById(inputId);
    const icon = input.nextElementSibling;
    if (input.type === "password") {
        input.type = "text";
        icon.textContent = "üîí";
    } else {
        input.type = "password";
        icon.textContent = "üëÅÔ∏è";
    }
}

// 3. Strength Listener (Now it will find passwordInput)
passwordInput.addEventListener("input", () => {
    const val = passwordInput.value;
    let strength = 0;

    if (val.length >= 8) strength++;
    if (/[A-Z]/.test(val)) strength++;
    if (/[0-9]/.test(val)) strength++;
    if (/[^A-Za-z0-9]/.test(val)) strength++;

    const levels = [
        { w: "0%", c: "#e5e7eb", t: "Password strength" },
        { w: "25%", c: "#ef4444", t: "Weak" },
        { w: "50%", c: "#f59e0b", t: "Fair" },
        { w: "75%", c: "#22c55e", t: "Strong" },
        { w: "100%", c: "#16a34a", t: "Very Strong" }
    ];

    bar.style.width = levels[strength].w;
    bar.style.background = levels[strength].c;
    text.textContent = levels[strength].t;
});

/* Handle Reset */
function handleReset(e) {
    e.preventDefault();

    const matric = document.getElementById("matric").value;
    const email = document.getElementById("email").value;
    const newPass = passwordInput.value;

    if (newPass.length < 8) {
        show("Password must be at least 8 characters.", false);
        return;
    }

    const key = "user_" + matric;
    const stored = localStorage.getItem(key);

    if (!stored) {
        show("No account found with this Matric Number.", false);
        return;
    }

    const user = JSON.parse(stored);

    if (user.email !== email) {
        show("Email does not match our records.", false);
        return;
    }

    btn.disabled = true;
    btn.textContent = "Updating...";

    setTimeout(() => {
        user.password = newPass;
        localStorage.setItem(key, JSON.stringify(user));

        show("Password updated successfully. Redirecting...", true);

        setTimeout(() => {
            window.location.href = "login.html";
        }, 2000);
    }, 1200);
}

/* Message UI */
function show(text, success = false) {
    const msg = document.getElementById("msg");
    msg.textContent = text;
    msg.style.display = "block";

    msg.style.background = success ? "#f0fdf4" : "#fef2f2";
    msg.style.color = success ? "#166534" : "#991b1b";
    msg.style.border = success
        ? "1px solid #bbf7d0"
        : "1px solid #fecaca";
}
</script>
</body>
</html>